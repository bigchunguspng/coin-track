<Window x:Class="CoinTrack.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CoinTrack.View"
        xmlns:vm="clr-namespace:CoinTrack.ViewModel"
        mc:Ignorable="d"
        Title="CoinTrack"
        CacheMode="BitmapCache"
        WindowStyle="None"
        WindowStartupLocation="CenterScreen"
        Width="1280" Height="720"
        MinWidth="960" MinHeight="720"
        Background="White">

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="30"
            ResizeBorderThickness="6"
            GlassFrameThickness="-1" />
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <Style TargetType="ContentControl" BasedOn="{StaticResource Plain}" />
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="#212529" />
        </Style>
        <SolidColorBrush x:Key="LightGreen" Color="#e8fcc9" />
    </Window.Resources>

    <DockPanel> <!--Root-container-->

        <DockPanel.Style>
            <Style>
                <Style.Triggers>
                    <DataTrigger
                        Binding="{Binding WindowState, RelativeSource={RelativeSource AncestorType=Window}}"
                        Value="Maximized">
                        <Setter Property="Control.Margin" Value="7" /> <!--Fixing fullscreen size-->
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </DockPanel.Style>

        <!--Title bar-->

        <Grid DockPanel.Dock="Top" Background="{StaticResource LightGreen}">
            <TextBlock
                Text="CoinTrack" Margin="10 0" Foreground="#3c3c3c"
                VerticalAlignment="Center" HorizontalAlignment="Left" />
            <StackPanel
                WindowChrome.IsHitTestVisibleInChrome="True"
                Height="30"
                VerticalAlignment="Center"
                HorizontalAlignment="Right"
                Orientation="Horizontal">

                <Button Name="Minimize" Style="{StaticResource TitleBarButton}" Content="&#xE949;" />
                <Button Name="Maximize" Style="{StaticResource MaximizeButton}" />
                <Button Name="CloseWindow" Style="{StaticResource CloseButton}" Content="&#xE8BB;" />
            </StackPanel>
        </Grid>

        <!--Tabs-->

        <ListView
            DockPanel.Dock="Top"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
            ItemsSource="{Binding TabBar.Tabs}"
            SelectedItem="{Binding TabBar.ActiveTab}"
            ItemContainerStyle="{StaticResource Tab}"
            BorderThickness="0 0 0 2" BorderBrush="#B4E29C"
            Margin="0" Padding="-1 4 -1 -1"
            FocusVisualStyle="{x:Null}"
            Background="{StaticResource LightGreen}">

            <ListView.ItemTemplate>
                <DataTemplate>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock
                            Text="{Binding Page.Title}" Padding="10" />
                        <Button
                            Command="{Binding CloseTab}"
                            Content="×"
                            Style="{StaticResource TabClose}" />
                        <StackPanel.InputBindings>
                            <MouseBinding Command="{Binding CloseTab}" MouseAction="MiddleClick" />
                        </StackPanel.InputBindings>
                    </StackPanel>

                </DataTemplate>
            </ListView.ItemTemplate>
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel />
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
        </ListView>

        <Frame 
            NavigationUIVisibility="Hidden"
            Content="{Binding TabBar.ActiveTab.Page}" />

    </DockPanel>

    <Window.InputBindings>
        <KeyBinding
            Command="{Binding TabBar.TabSwitchLeft}"
            Modifiers="Alt" Key="PageUp" />
        <KeyBinding
            Command="{Binding TabBar.TabSwitchRight}"
            Modifiers="Alt" Key="PageDown" />
        <KeyBinding
            Command="{Binding TabBar.CloseActiveTab}"
            Modifiers="Control" Key="W" />
        <KeyBinding
            Command="{Binding OpenMainPage}"
            Modifiers="Control" Key="M" />
    </Window.InputBindings>
    <Window.ContextMenu>
        <ContextMenu>
            <MenuItem Command="{Binding OpenMainPage}" Header="Open main page" InputGestureText="Ctrl+M" />
        </ContextMenu>
    </Window.ContextMenu>
</Window>